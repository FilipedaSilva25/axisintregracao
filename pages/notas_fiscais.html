<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AXIS Documents - Sistema Inteligente de Notas Fiscais</title>
    
    <!-- CSS Principal -->
    <link rel="stylesheet" href="../css/notas_fiscais.css">
    <link rel="stylesheet" href="../css/notas_fiscais_configuracoes.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Favicon Axis -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚡</text></svg>">
    <meta name="theme-color" content="#4361ee">
</head>
<body>
    <!-- ================= ESTRUTURA PRINCIPAL ================= -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">⚡</span>
                    <h2>AXIS <span class="logo-sub">Documents</span></h2>
                </div>
                <button class="sidebar-close" onclick="toggleSidebar()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sidebar-user">
                <span class="user-name-only" id="user-name">Carregando...</span>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3 class="nav-title">Principal</h3>
                    <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showSection('notas')">
                        <i class="fas fa-file-invoice"></i>
                        <span>Notas Fiscais</span>
                        <span class="nav-badge" id="nf-count">0</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showSection('fornecedores')">
                        <i class="fas fa-building"></i>
                        <span>Fornecedores</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showSection('relatorios')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Relatórios</span>
                    </a>
                    <a href="#" class="nav-item" onclick="mostrarLixeira()">
                        <i class="fas fa-trash-alt"></i>
                        <span>Lixeira</span>
                        <span class="nav-badge" id="lixeira-count">0</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <h3 class="nav-title">Ferramentas</h3>
                    <a href="#" class="nav-item" onclick="abrirScanner()">
                        <i class="fas fa-camera"></i>
                        <span>Scanner</span>
                    </a>
                    <a href="#" class="nav-item" onclick="abrirImportacaoXML()">
                        <i class="fas fa-file-code"></i>
                        <span>Importar XML</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showSection('backup')">
                        <i class="fas fa-database"></i>
                        <span>Backup</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showSection('configuracoes')">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </div>
                
            </nav>
            
            <div class="sidebar-footer">
                <button class="nav-item logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sair do Sistema</span>
                </button>
                <div class="version">v2.0.0 ⚡</div>
            </div>
        </aside>
        
        <!-- Overlay para menu hambúrguer -->
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>
        
        <!-- Conteúdo Principal -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="page-title">
                        <h1 id="page-title">Dashboard</h1>
                        <p class="page-subtitle" id="page-subtitle">Sistema inteligente de gestão fiscal</p>
                    </div>
                </div>
                
                <div class="header-center">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" 
                               class="search-input" 
                               id="global-search" 
                               placeholder="Buscar notas fiscais..." 
                               onkeyup="handleSearch()">
                        <button class="search-filter" onclick="toggleAdvancedSearch()">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>
                
                <div class="header-right">
                    <button class="header-btn" onclick="toggleTheme()" title="Alternar tema">
                        <i class="fas fa-moon" id="theme-icon"></i>
                    </button>
                    
                    <button class="header-btn" onclick="abrirCommandPalette()" title="Command Palette (Ctrl+K)">
                        <i class="fas fa-terminal"></i>
                    </button>
                    
                    <div class="notifications" onclick="toggleNotifications()">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-badge">0</span>
                    </div>
                    
                    <button class="btn-primary" onclick="abrirUpload()">
                        <i class="fas fa-plus"></i>
                        <span>Nova NF</span>
                    </button>
                </div>
            </header>
            
            <!-- Painel de Busca Avançada -->
            <div class="advanced-search" id="advanced-search">
                <div class="search-filters">
                    <div class="filter-group">
                        <label>Período</label>
                        <div class="date-range">
                            <input type="date" id="date-from">
                            <span>até</span>
                            <input type="date" id="date-to">
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label>Valor</label>
                        <div class="value-range">
                            <input type="number" id="value-min" placeholder="Mínimo">
                            <span>até</span>
                            <input type="number" id="value-max" placeholder="Máximo">
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label>Tipo</label>
                        <select id="filter-tipo">
                            <option value="all">Todos</option>
                            <option value="entrada">Entrada</option>
                            <option value="saida">Saída</option>
                            <option value="servico">Serviço</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Status</label>
                        <select id="filter-status">
                            <option value="all">Todos</option>
                            <option value="pendente">Pendente</option>
                            <option value="pago">Pago</option>
                            <option value="vencido">Vencido</option>
                        </select>
                    </div>
                    
                    <div class="filter-actions">
                        <button class="btn-secondary" onclick="limparFiltros()">Limpar</button>
                        <button class="btn-primary" onclick="aplicarFiltros()">Aplicar</button>
                    </div>
                </div>
            </div>
            
            <!-- Notifications Panel -->
            <div class="notifications-panel" id="notifications-panel">
                <div class="notifications-header">
                    <h3><i class="fas fa-bell"></i> Notificações</h3>
                    <button class="close-btn" onclick="toggleNotifications()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="notifications-list" id="notifications-list">
                    <!-- Notificações serão carregadas aqui -->
                </div>
            </div>
            
            <!-- Conteúdo das Páginas -->
            <div class="content-wrapper">
                <!-- Dashboard -->
                <section id="dashboard" class="content-section active">
                    <div class="dashboard-header">
                        <h2><i class="fas fa-chart-line"></i> Dashboard Financeiro</h2>
                        <p>Visão geral inteligente das suas notas fiscais</p>
                    </div>
                    
                    <!-- Axis Smart Widgets -->
                    <div class="charts-grid" id="axis-smart-widgets">
                        <!-- Widgets serão carregados dinamicamente -->
                    </div>
                    
                    <!-- Estatísticas Completas -->
                    <div class="stats-grid">
                        <div class="stat-card axis-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-file-invoice-dollar"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-nfs">0</h3>
                                <p>Total de NFs</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card stat-card-valor-total">
                            <div class="stat-icon success">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="valor-total-nfs">R$ 0,00</h3>
                                <p>Valor Total</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="pendentes-nfs">0</h3>
                                <p>Pendentes</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon danger">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="vencidas-nfs">0</h3>
                                <p>Vencidas</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, rgba(255, 204, 0, 0.2), rgba(255, 204, 0, 0.1)); color: #ffcc00;">
                                <i class="fas fa-hourglass-half"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="a-vencer-nfs">0</h3>
                                <p>A Vencer</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="pagas-nfs">0</h3>
                                <p>Pagas</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, rgba(142, 68, 173, 0.2), rgba(142, 68, 173, 0.1)); color: #8e44ad;">
                                <i class="fas fa-calendar-times"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="em-atraso-nfs">0</h3>
                                <p>Em Atraso</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="concluidas-mes-nfs">0</h3>
                                <p>Concluídas este Mês</p>
                            </div>
                        </div>
                        
                        <div class="stat-card axis-card">
                            <div class="stat-icon success">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="valor-medio-nfs">R$ 0,00</h3>
                                <p>Valor Médio por Nota</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos Completos -->
                    <div class="charts-grid">
                        <div class="chart-card axis-card">
                            <h3><i class="fas fa-chart-pie"></i> Distribuição por Status</h3>
                            <div class="chart-container">
                                <canvas id="chart-status"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card axis-card">
                            <h3><i class="fas fa-chart-line"></i> Entrada de Notas (6 meses)</h3>
                            <div class="chart-container">
                                <canvas id="chart-timeline"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card axis-card">
                            <h3><i class="fas fa-chart-bar"></i> Distribuição por Tipo</h3>
                            <div class="chart-container">
                                <canvas id="chart-tipo"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Últimas Notas -->
                    <div class="recent-nfs axis-card">
                        <div class="section-header">
                            <h3><i class="fas fa-history"></i> Últimas Notas Fiscais</h3>
                            <button class="btn-secondary" onclick="showSection('notas')">
                                Ver Todas
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Fornecedor</th>
                                        <th>Data</th>
                                        <th>Valor</th>
                                        <th>Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-nfs-table">
                                    <!-- Últimas NFs serão carregadas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- Lixeira -->
                <section id="lixeira" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-trash-alt"></i> Lixeira</h2>
                        <p>Notas fiscais excluídas</p>
                    </div>
                    
                    <div class="lixeira-actions" style="margin-bottom: 24px; display: flex; gap: 12px; align-items: center;">
                        <button class="btn-secondary" onclick="esvaziarLixeira()">
                            <i class="fas fa-trash"></i> Esvaziar Lixeira
                        </button>
                        <button class="btn-secondary" onclick="restaurarTodasLixeira()">
                            <i class="fas fa-undo"></i> Restaurar Todas
                        </button>
                    </div>
                    
                    <!-- Grid de Notas da Lixeira -->
                    <div class="nfs-grid" id="lixeira-grid">
                        <!-- Notas da lixeira serão carregadas aqui -->
                    </div>
                    
                    <!-- Lista de Notas da Lixeira -->
                    <div class="nfs-list" id="lixeira-list" style="display: none;">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Número NF</th>
                                        <th>Fornecedor</th>
                                        <th>Data Emissão</th>
                                        <th>Valor</th>
                                        <th>Excluído em</th>
                                        <th>Dias Restantes</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="lixeira-table-body">
                                    <!-- Notas da lixeira serão carregadas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- Lista de Notas Fiscais -->
                <section id="notas" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-file-invoice"></i> Biblioteca de Notas Fiscais</h2>
                        <p>Gerencie todas as suas notas fiscais em um só lugar</p>
                    </div>
                    
                    <!-- Filtros Rápidos -->
                    <div class="quick-filters">
                        <div class="filter-tabs">
                            <button class="filter-tab active" onclick="filtrarPorStatus('all')">
                                <i class="fas fa-layer-group"></i> Todas
                            </button>
                            <button class="filter-tab" onclick="filtrarPorStatus('pendente')">
                                <i class="fas fa-clock"></i> Pendentes
                            </button>
                            <button class="filter-tab" onclick="filtrarPorStatus('pago')">
                                <i class="fas fa-check-circle"></i> Pagas
                            </button>
                            <button class="filter-tab" onclick="filtrarPorStatus('vencido')">
                                <i class="fas fa-exclamation-triangle"></i> Vencidas
                            </button>
                            <button class="filter-tab" onclick="filtrarPorStatus('a-vencer')">
                                <i class="fas fa-hourglass-half"></i> A Vencer
                            </button>
                        </div>
                        
                        <div class="view-controls">
                            <button class="view-btn active" id="view-grid-btn" onclick="changeView('grid')" title="Visualização em Grid">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button class="view-btn" id="view-list-btn" onclick="changeView('list')" title="Visualização em Lista">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Barra de Ações em Massa -->
                    <div class="batch-actions-bar" id="batch-actions-bar" style="display: none;">
                        <div class="batch-actions-content">
                            <span class="batch-count" id="batch-count">0 selecionadas</span>
                            <div class="batch-actions-buttons">
                                <button class="batch-btn" onclick="alterarStatusEmMassa()" title="Alterar Status">
                                    <i class="fas fa-edit"></i> Alterar Status
                                </button>
                                <button class="batch-btn" onclick="exportarEmMassa()" title="Exportar">
                                    <i class="fas fa-file-export"></i> Exportar
                                </button>
                                <button class="batch-btn" onclick="enviarEmailEmMassa()" title="Enviar Email">
                                    <i class="fas fa-envelope"></i> Enviar Email
                                </button>
                                <button class="batch-btn" onclick="aplicarTagEmMassa()" title="Aplicar Tag">
                                    <i class="fas fa-tag"></i> Aplicar Tag
                                </button>
                                <button class="batch-btn batch-btn-danger" onclick="excluirEmMassa()" title="Excluir">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                            <button class="batch-close" onclick="fecharBarraAcoesMassa()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Grid de Notas -->
                    <div class="nfs-grid" id="nfs-grid">
                        <!-- Notas serão carregadas aqui -->
                    </div>
                    
                    <!-- Lista de Notas -->
                    <div class="nfs-list" id="nfs-list" style="display: none;">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th class="col-checkbox">
                                            <input type="checkbox" id="select-all-nfs" onchange="selecionarTodasNotas()">
                                        </th>
                                        <th onclick="sortTable('numero')">Número NF</th>
                                        <th onclick="sortTable('fornecedor')">Fornecedor</th>
                                        <th onclick="sortTable('data')">Data Emissão</th>
                                        <th onclick="sortTable('vencimento')">Data Vencimento</th>
                                        <th onclick="sortTable('valor')">Valor</th>
                                        <th onclick="sortTable('status')">Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="nfs-table-body">
                                    <!-- Notas em lista serão carregadas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Paginação -->
                    <div class="pagination" id="pagination">
                        <!-- Paginação será gerada aqui -->
                    </div>
                </section>
                
                <!-- Seção de Relatórios Avançados -->
                <section id="relatorios" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-line"></i> Relatórios Avançados</h2>
                        <p>Análises detalhadas e relatórios personalizados</p>
                    </div>
                    
                    <!-- Filtros do Relatório -->
                    <div class="report-filters axis-card">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Período</label>
                                <select id="report-period" class="report-select">
                                    <option value="current_month">Este Mês</option>
                                    <option value="last_month">Mês Anterior</option>
                                    <option value="current_quarter">Este Trimestre</option>
                                    <option value="current_year">Este Ano</option>
                                    <option value="custom">Personalizado</option>
                                </select>
                            </div>
                            
                            <div class="filter-group" id="custom-dates" style="display: none;">
                                <label>Datas Personalizadas</label>
                                <div class="date-inputs">
                                    <input type="date" id="report-date-from">
                                    <span>até</span>
                                    <input type="date" id="report-date-to">
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label>Tipo de Relatório</label>
                                <select id="report-type" class="report-select">
                                    <option value="financial">Financeiro</option>
                                    <option value="tax">Fiscal/Tributário</option>
                                    <option value="supplier">Por Fornecedor</option>
                                    <option value="category">Por Categoria</option>
                                    <option value="status">Por Status</option>
                                </select>
                            </div>
                            
                            <button class="btn-primary" onclick="gerarRelatorioAvancado()">
                                <i class="fas fa-cogs"></i> Gerar Relatório
                            </button>
                            
                            <div class="export-dropdown-wrap">
                                <button type="button" class="btn-primary btn-export-toggle" id="btn-export-toggle" onclick="toggleExportMenu()">
                                    <i class="fas fa-file-export"></i> Exportar <i class="fas fa-chevron-down" style="margin-left:4px;font-size:11px;"></i>
                                </button>
                                <div class="export-menu" id="export-menu">
                                    <button type="button" class="export-item" onclick="exportarRelatorioPorFormato('pdf')"><i class="fas fa-file-pdf"></i> PDF</button>
                                    <button type="button" class="export-item" onclick="exportarRelatorioPorFormato('excel')"><i class="fas fa-file-excel"></i> Excel</button>
                                    <button type="button" class="export-item" onclick="exportarRelatorioPorFormato('google-doc')"><i class="fab fa-google"></i> Google Documento</button>
                                    <button type="button" class="export-item" onclick="exportarRelatorioPorFormato('google-sheets')"><i class="fas fa-table"></i> Google Planilhas</button>
                                    <button type="button" class="export-item" onclick="exportarRelatorioPorFormato('txt')"><i class="fas fa-file-alt"></i> TXT</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dashboard de Relatórios -->
                    <div class="report-dashboard">
                        <div class="report-cards">
                            <div class="report-card axis-card">
                                <h3><i class="fas fa-money-bill-wave"></i> Resumo Financeiro</h3>
                                <div class="report-content" id="financial-summary">
                                    <!-- Será preenchido por JS -->
                                </div>
                            </div>
                            
                            <div class="report-card axis-card">
                                <h3><i class="fas fa-chart-pie"></i> Distribuição</h3>
                                <div class="chart-container">
                                    <canvas id="report-chart-distribution"></canvas>
                                </div>
                            </div>
                            
                            <div class="report-card axis-card">
                                <h3><i class="fas fa-trend-up"></i> Evolução</h3>
                                <div class="chart-container">
                                    <canvas id="report-chart-evolution"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tabela Detalhada -->
                        <div class="report-table axis-card">
                            <h3><i class="fas fa-table"></i> Detalhamento</h3>
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>NF-e</th>
                                            <th>Fornecedor</th>
                                            <th>Data</th>
                                            <th>Valor</th>
                                            <th>ICMS</th>
                                            <th>PIS/COFINS</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="report-details">
                                        <!-- Será preenchido por JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Relatório para Contabilidade -->
                    <div class="accounting-report axis-card">
                        <div class="section-header">
                            <h3><i class="fas fa-calculator"></i> Relatório Contábil</h3>
                            <button class="btn-primary" onclick="gerarRelatorioContabil()">
                                <i class="fas fa-file-pdf"></i> Gerar PDF Contábil
                            </button>
                        </div>
                        
                        <div class="accounting-summary" id="accounting-summary">
                            <!-- Será preenchido por JS -->
                        </div>
                    </div>
                </section>
                
                <!-- Seção de Backup -->
                <section id="backup" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-database"></i> Backup e Restauração</h2>
                        <p>Gerencie backups e restore seus dados</p>
                    </div>
                    
                    <div class="backup-container">
                        <div class="backup-card axis-card">
                            <div class="backup-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h3>Backup Automático</h3>
                            <p>Configure backups automáticos dos seus dados</p>
                            
                            <div class="backup-settings">
                                <div class="setting">
                                    <label>
                                        <input type="checkbox" id="auto-backup" checked>
                                        Backup automático
                                    </label>
                                </div>
                                
                                <div class="setting">
                                    <label>Frequência</label>
                                    <select id="backup-frequency">
                                        <option value="daily">Diário</option>
                                        <option value="weekly">Semanal</option>
                                        <option value="monthly">Mensal</option>
                                    </select>
                                </div>
                                
                                <div class="setting">
                                    <label>Local de Backup</label>
                                    <select id="backup-location">
                                        <option value="local">Local (navegador)</option>
                                        <option value="google_drive">Google Drive</option>
                                        <option value="dropbox">Dropbox</option>
                                    </select>
                                </div>
                            </div>
                            
                            <button class="btn-primary" onclick="salvarConfigBackup()">
                                <i class="fas fa-save"></i> Salvar Configurações
                            </button>
                        </div>
                        
                        <div class="backup-card axis-card">
                            <div class="backup-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <h3>Backup Manual</h3>
                            <p>Faça backup manual dos seus dados</p>
                            
                            <div class="backup-actions">
                                <button class="btn-primary" onclick="criarBackup()">
                                    <i class="fas fa-file-export"></i> Criar Backup Agora
                                </button>
                                
                                <button class="btn-secondary" onclick="exportarBackupJSON()">
                                    <i class="fas fa-code"></i> Exportar JSON
                                </button>
                                
                                <button class="btn-secondary" onclick="exportarBackupCSV()">
                                    <i class="fas fa-file-csv"></i> Exportar CSV
                                </button>
                            </div>
                            
                            <div class="backup-list">
                                <h4>Backups Disponíveis</h4>
                                <div id="backup-list">
                                    <!-- Lista de backups será carregada aqui -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="backup-card axis-card">
                            <div class="backup-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <h3>Restauração</h3>
                            <p>Restore dados de backups anteriores</p>
                            
                            <div class="restore-actions">
                                <div class="file-upload">
                                    <input type="file" id="restore-file" accept=".json,.csv" style="display: none;">
                                    <button class="btn-secondary" onclick="document.getElementById('restore-file').click()">
                                        <i class="fas fa-file-import"></i> Selecionar Arquivo
                                    </button>
                                </div>
                                
                                <button class="btn-primary" onclick="restaurarBackup()">
                                    <i class="fas fa-redo"></i> Restaurar Backup
                                </button>
                            </div>
                            
                            <div class="restore-info">
                                <p><i class="fas fa-info-circle"></i> Formatos suportados: JSON, CSV</p>
                                <p><i class="fas fa-exclamation-triangle"></i> A restauração sobrescreverá os dados atuais</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Seção de Configurações Avançadas -->
                <section id="configuracoes" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-sliders-h"></i> Configurações Avançadas</h2>
                        <p>Configure o sistema conforme suas necessidades</p>
                    </div>
                    
                    <div class="settings-tabs axis-card">
                        <div class="tab-buttons">
                            <button class="tab-btn active" onclick="openSettingsTab('geral')">Geral</button>
                            <button class="tab-btn" onclick="openSettingsTab('notificacoes')">Notificações</button>
                            <button class="tab-btn" onclick="openSettingsTab('integracao')">Integração</button>
                            <button class="tab-btn" onclick="openSettingsTab('seguranca')">Segurança</button>
                        </div>
                        
                        <!-- Aba Geral -->
                        <div class="tab-content active" id="tab-geral">
                            <div class="settings-group">
                                <h3><i class="fas fa-cog"></i> Configurações Gerais</h3>
                                
                                <div class="setting-item">
                                    <label for="settings-items-per-page">Itens por página</label>
                                    <select id="settings-items-per-page">
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>
                                        <option value="30">30</option>
                                        <option value="50">50</option>
                                    </select>
                                </div>
                                
                                <div class="setting-item">
                                    <label for="settings-default-view">Visualização padrão</label>
                                    <select id="settings-default-view">
                                        <option value="grid">Grade</option>
                                        <option value="list">Lista</option>
                                    </select>
                                </div>
                                
                                <div class="setting-item">
                                    <label for="settings-currency">Moeda padrão</label>
                                    <select id="settings-currency">
                                        <option value="BRL">Real (R$)</option>
                                        <option value="USD">Dólar (US$)</option>
                                        <option value="EUR">Euro (€)</option>
                                    </select>
                                </div>
                                
                                <div class="setting-item">
                                    <label for="settings-date-format">Formato de data</label>
                                    <select id="settings-date-format">
                                        <option value="pt-BR">DD/MM/AAAA</option>
                                        <option value="en-US">MM/DD/AAAA</option>
                                        <option value="en-GB">DD/MM/AAAA</option>
                                    </select>
                                </div>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="settings-auto-save">
                                        Salvar automaticamente
                                    </label>
                                </div>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="settings-animations">
                                        Animações de interface
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Aba Notificações -->
                        <div class="tab-content" id="tab-notificacoes">
                            <div class="settings-group">
                                <h3><i class="fas fa-bell"></i> Configurações de Notificação</h3>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="notify-expiring" checked>
                                        Notificar sobre NFs próximas do vencimento
                                    </label>
                                </div>
                                
                                <div class="setting-item">
                                    <label>Dias para alerta de vencimento</label>
                                    <input type="number" id="notify-days-before" min="1" max="30" value="7">
                                </div>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="notify-new" checked>
                                        Notificar sobre novas NFs
                                    </label>
                                </div>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="notify-backup" checked>
                                        Notificar sobre backups
                                    </label>
                                </div>
                                
                                <div class="setting-item">
                                    <label>Som de notificação</label>
                                    <select id="notification-sound">
                                        <option value="none">Nenhum</option>
                                        <option value="default">Padrão</option>
                                        <option value="chime">Sino</option>
                                        <option value="bell">Campainha</option>
                                    </select>
                                </div>
                                
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="desktop-notifications">
                                        Notificações na área de trabalho
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Aba Integração -->
                        <div class="tab-content" id="tab-integracao">
                            <div class="settings-group">
                                <h3><i class="fas fa-plug"></i> Integrações</h3>
                                
                                <div class="setting-item">
                                    <h4><i class="fab fa-google-drive"></i> Google Drive</h4>
                                    <div class="integration-status" id="google-drive-status">
                                        <span class="status-badge disconnected">Não conectado</span>
                                        <button class="btn-secondary" onclick="conectarGoogleDrive()">
                                            <i class="fas fa-plug"></i> Conectar
                                        </button>
                                    </div>
                                    <p class="setting-description">
                                        Conecte com o Google Drive para backup automático de suas notas fiscais
                                    </p>
                                </div>
                                
                                <div class="setting-item">
                                    <h4><i class="fas fa-envelope"></i> E-mail</h4>
                                    <div class="email-settings">
                                        <label>Servidor SMTP</label>
                                        <input type="text" id="smtp-server" placeholder="smtp.gmail.com" value="smtp.gmail.com">
                                        
                                        <label>Porta</label>
                                        <input type="number" id="smtp-port" value="587" min="1" max="65535">
                                        
                                        <label>E-mail</label>
                                        <input type="email" id="smtp-email" placeholder="seu@email.com">
                                        
                                        <button class="btn-secondary" onclick="testarEmail()" style="margin-top: 8px;">
                                            <i class="fas fa-check-circle"></i> Testar Conexão
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <h4><i class="fas fa-sync"></i> Sincronização</h4>
                                    <label>
                                        <input type="checkbox" id="sync-cloud">
                                        Sincronizar automaticamente com nuvem
                                    </label>
                                    <div class="sync-options" style="margin-top: 10px;">
                                        <label>Intervalo de sincronização</label>
                                        <select id="sync-interval">
                                            <option value="15">15 minutos</option>
                                            <option value="30">30 minutos</option>
                                            <option value="60">1 hora</option>
                                            <option value="1440">1 dia</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Aba Segurança -->
                        <div class="tab-content" id="tab-seguranca">
                            <div class="settings-group">
                                <h3><i class="fas fa-shield-alt"></i> Segurança</h3>
                                
                                <div class="setting-item">
                                    <h4>Senha de Acesso</h4>
                                    <div class="password-change">
                                        <label>Senha atual</label>
                                        <input type="password" id="current-password">
                                        
                                        <label>Nova senha</label>
                                        <input type="password" id="new-password">
                                        
                                        <label>Confirmar nova senha</label>
                                        <input type="password" id="confirm-password">
                                        
                                        <button class="btn-primary" onclick="changePassword()">
                                            Alterar Senha
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <h4>Autenticação</h4>
                                    <div class="auth-settings">
                                        <label>
                                            <input type="checkbox" id="two-factor-auth" onchange="if(typeof toggle2FA === 'function') toggle2FA();">
                                            Autenticação em dois fatores (2FA)
                                        </label>
                                        
                                        <div class="auth-methods" id="auth-methods" style="margin-top: 16px; display: none;">
                                            <label>Método de autenticação</label>
                                            <select id="two-factor-method">
                                                <option value="email">E-mail</option>
                                                <option value="authenticator">Google Authenticator</option>
                                                <option value="sms">SMS</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <h4>Sessão</h4>
                                    <div class="session-settings">
                                        <label>Tempo de sessão</label>
                                        <select id="session-timeout">
                                            <option value="15">15 minutos</option>
                                            <option value="30">30 minutos</option>
                                            <option value="60">1 hora</option>
                                            <option value="480">8 horas</option>
                                            <option value="1440">1 dia</option>
                                        </select>
                                        
                                        <label style="margin-top: 10px; display: block;">
                                            <input type="checkbox" id="auto-logout">
                                            Logout automático
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-actions">
                        <button class="btn-primary" onclick="saveSettings()">
                            <i class="fas fa-save"></i> Salvar Configurações
                        </button>
                        <button class="btn-secondary" onclick="resetSettings()">
                            <i class="fas fa-undo"></i> Restaurar Padrões
                        </button>
                        <button class="btn-danger" onclick="resetAllData()">
                            <i class="fas fa-trash"></i> Resetar Todos os Dados
                        </button>
                    </div>
                </section>
                
                <!-- Seção de Fornecedores -->
                <section id="fornecedores" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-building"></i> Fornecedores</h2>
                        <p>Gerencie todos os seus fornecedores</p>
                    </div>
                    
                    <!-- Actions Bar -->
                    <div class="actions-bar axis-card">
                        <button class="btn-primary" onclick="abrirCadastroFornecedor()">
                            <i class="fas fa-plus"></i> Novo Fornecedor
                        </button>
                        
                        <div class="search-container-sm">
                            <i class="fas fa-search"></i>
                            <input type="text" id="supplier-search" placeholder="Buscar fornecedor..." onkeyup="searchSuppliers()">
                        </div>
                        
                        <button class="btn-secondary" onclick="exportarFornecedores()">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                    </div>
                    
                    <!-- Suppliers Grid -->
                    <div class="suppliers-grid" id="suppliers-grid">
                        <!-- Fornecedores serão carregados aqui -->
                    </div>
                    
                    <!-- Suppliers Table -->
                    <div class="suppliers-table axis-card">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>CNPJ</th>
                                        <th>Nome</th>
                                        <th>E-mail</th>
                                        <th>Telefone</th>
                                        <th>Notas</th>
                                        <th>Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="suppliers-table-body">
                                    <!-- Fornecedores em lista serão carregados aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
            
            <!-- Axis Command Palette -->
            <div class="command-palette" id="command-palette" style="display: none;">
                <div class="command-palette-content">
                    <div class="command-palette-header">
                        <i class="fas fa-terminal"></i>
                        <input type="text" id="command-input" placeholder="Digite um comando..." onkeyup="filtrarComandos(event)" onkeydown="executarComando(event)">
                        <span style="font-size: 12px; color: var(--text-secondary);">(Ctrl+K)</span>
                        <button class="close-btn" onclick="fecharCommandPalette()" style="background: transparent; border: none; cursor: pointer; color: var(--text-secondary); padding: 4px; margin-left: 8px;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="command-palette-list" id="command-palette-list">
                        <!-- Comandos serão renderizados dinamicamente pelo JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Axis AI Assistant - REMOVIDO TEMPORARIAMENTE -->
            <div class="ai-assistant" id="ai-assistant" style="display: none !important;">
                <div class="ai-header">
                    <div class="ai-title">
                        <i class="fas fa-robot"></i>
                        <h3>Axis AI Assistant</h3>
                    </div>
                    <button class="close-btn" onclick="toggleAIAssistant()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="ai-messages" id="ai-messages">
                    <div class="ai-message">
                        <div class="ai-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <p>Olá! Eu sou o Axis AI, seu assistente virtual. Como posso ajudá-lo hoje?</p>
                        </div>
                    </div>
                </div>
                <div class="ai-input">
                    <input type="text" id="ai-input" placeholder="Pergunte algo sobre suas notas fiscais...">
                    <button class="ai-send" onclick="sendAIMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <!-- Footer -->
        </main>
    </div>

    <!-- ================= MODAIS E POPUPS ================= -->
    
    <!-- Modal de Upload -->
    <div class="modal" id="upload-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cloud-upload-alt"></i> Upload de Nota Fiscal</h3>
                <button class="modal-close" onclick="closeModal('upload-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="upload-zone" id="upload-zone">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Arraste e solte sua nota fiscal aqui</p>
                    <span>ou</span>
                    <button class="btn-primary" onclick="document.getElementById('file-input').click()">
                        Selecione o arquivo
                    </button>
                    <input type="file" id="file-input" accept=".pdf,.jpg,.jpeg,.png,.xml" style="display: none;">
                </div>
                
                <div class="upload-options">
                    <h4>Opções de Upload</h4>
                    <div class="options-grid">
                        <div class="option">
                            <input type="checkbox" id="auto-detect" checked>
                            <label for="auto-detect">Detecção automática de dados</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="save-backup">
                            <label for="save-backup">Salvar backup automático</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="notify-upload" checked>
                            <label for="notify-upload">Notificar após upload</label>
                        </div>
                    </div>
                </div>
                
                <div class="upload-progress" id="upload-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <span id="progress-text">0%</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('upload-modal')">Cancelar</button>
                <button class="btn-primary" onclick="processarUpload()">Processar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Scanner -->
    <div class="modal" id="scanner-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-camera"></i> Scanner de Nota Fiscal</h3>
                <button class="modal-close" onclick="closeModal('scanner-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="scanner-container">
                    <div class="scanner-view" id="scanner-view">
                        <video id="scanner-video" autoplay playsinline></video>
                        <canvas id="scanner-canvas" style="display: none;"></canvas>
                        <div class="scanner-overlay"></div>
                    </div>
                    
                    <div class="scanner-controls">
                        <button class="btn-secondary" id="start-scanner" onclick="startScanner()">
                            <i class="fas fa-play"></i> Iniciar Scanner
                        </button>
                        <button class="btn-secondary" id="stop-scanner" onclick="stopScanner()" disabled>
                            <i class="fas fa-stop"></i> Parar Scanner
                        </button>
                        <button class="btn-primary" id="capture-btn" onclick="captureImage()" disabled>
                            <i class="fas fa-camera"></i> Capturar
                        </button>
                    </div>
                </div>
                
                <div class="scanner-result" id="scanner-result" style="display: none;">
                    <h4>Resultado do Scan</h4>
                    <div id="scan-result-content"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('scanner-modal')">Fechar</button>
                <button class="btn-primary" onclick="saveScanResult()" id="save-scan-btn" disabled>
                    Salvar Nota
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Importação XML -->
    <div class="modal" id="xml-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-code"></i> Importar Nota Fiscal XML</h3>
                <button class="modal-close" onclick="closeModal('xml-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="xml-upload">
                    <div class="upload-zone" id="xml-upload-zone">
                        <i class="fas fa-file-code"></i>
                        <p>Arraste e solte seu XML aqui</p>
                        <span>ou</span>
                        <button class="btn-primary" onclick="document.getElementById('xml-input').click()">
                            Selecione o arquivo XML
                        </button>
                        <input type="file" id="xml-input" accept=".xml" style="display: none;">
                    </div>
                </div>
                
                <div class="xml-preview" id="xml-preview" style="display: none;">
                    <h4>Pré-visualização da Nota Fiscal</h4>
                    <div class="xml-info" id="xml-info"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('xml-modal')">Cancelar</button>
                <button class="btn-primary" onclick="importarXML()" id="import-xml-btn" disabled>
                    Importar XML
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Detalhes da NF -->
    <div class="modal" id="nf-details-modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-file-invoice"></i> Detalhes da Nota Fiscal</h3>
                <button class="modal-close" onclick="closeModal('nf-details-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="nf-details-content">
                    <!-- Detalhes serão carregados aqui -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('nf-details-modal')">Fechar</button>
                <button class="btn-primary" onclick="editarNF()">Editar</button>
                <button class="btn-danger" onclick="excluirNF()">Excluir</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Validação de Chave -->
    <div class="modal" id="validate-key-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> Validar Chave de Acesso NF-e</h3>
                <button class="modal-close" onclick="closeModal('validate-key-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="validate-form">
                    <div class="form-group">
                        <label for="nf-key">Chave de Acesso da NF-e (44 dígitos)</label>
                        <input type="text" id="nf-key" placeholder="Ex: 12345678901234567890123456789012345678901234" maxlength="44">
                        <small class="form-help">Digite a chave de acesso completa da nota fiscal</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="nf-captcha">Código de Segurança</label>
                        <div class="captcha-container">
                            <div class="captcha-code" id="captcha-code">AXIS123</div>
                            <button type="button" class="captcha-refresh" onclick="refreshCaptcha()">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                        <input type="text" id="nf-captcha" placeholder="Digite o código acima">
                    </div>
                </div>
                
                <div class="validation-result" id="validation-result" style="display: none;">
                    <h4>Resultado da Validação</h4>
                    <div id="validation-result-content"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('validate-key-modal')">Cancelar</button>
                <button class="btn-primary" onclick="validarChaveNF()">Validar Chave</button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- ================= SCRIPTS ================= -->
    <script src="../js/notas_fiscais.js"></script>
    <script src="../js/notas_fiscais_features.js"></script>
    <script src="../js/notas_fiscais_integracao.js"></script>
    <script src="../js/notas_fiscais_botoes.js"></script>
    <script src="../js/notas_fiscais_funcoes_completas.js"></script>
    <script src="../js/notas_fiscais_lixeira_estrutura.js"></script>
    <script src="../js/notas_fiscais_preview_download.js"></script>
    <script src="../js/notas_fiscais_configuracoes.js"></script>
    
    <!-- Atalho Keyboard Shortcut para Command Palette -->
    <script>
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                if (typeof abrirCommandPalette !== 'undefined') {
                    abrirCommandPalette();
                } else if (typeof openCommandPalette !== 'undefined') {
                    openCommandPalette();
                }
            }
            
            // Fechar modais com ESC
            if (e.key === 'Escape') {
                if (typeof closeAllModals !== 'undefined') closeAllModals();
                
                const palette = document.getElementById('command-palette');
                if (palette && (palette.style.display === 'flex' || palette.classList.contains('show'))) {
                    if (typeof fecharCommandPalette !== 'undefined') {
                        fecharCommandPalette();
                    } else if (typeof closeCommandPalette !== 'undefined') {
                        closeCommandPalette();
                    } else {
                        palette.style.display = 'none';
                        palette.classList.remove('show');
                    }
                }
                
                // Axis AI desabilitado
                const aiAssistant = document.getElementById('ai-assistant');
                if (aiAssistant) {
                    aiAssistant.style.display = 'none !important';
                }
            }
        });
        
        // Atalho para Axis AI removido temporariamente
    </script>
</body>
</html>